<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projekt Chimera: Das Goldene Zeitalter</title>
    <link href="output.css" rel="stylesheet"> <!-- Lade von unpkg.com/tailwindcss@^3/dist/tailwind.min.css und nenne es output.css -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #0a0a1a;
            color: #e0e0e0;
            background-image: url('https://your-server.com/mars_colony.jpg');
            background-size: cover;
        }
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .resource-card {
            background-color: rgba(20, 20, 40, 0.7);
            border: 1px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        .action-button {
            background-color: rgba(0, 100, 100, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.5);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .action-button:hover {
            background-color: rgba(0, 200, 200, 0.7);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }
        .action-button:disabled {
            background-color: rgba(50, 50, 50, 0.5);
            border-color: rgba(100, 100, 100, 0.5);
            cursor: not-allowed;
        }
        .log-entry {
            border-left: 2px solid rgba(0, 255, 255, 0.5);
        }
        .progress-bar-container {
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.2);
        }
        .progress-bar {
            background: linear-gradient(90deg, rgba(0,255,255,1) 0%, rgba(0,150,255,1) 100%);
            transition: width 0.5s ease-in-out;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: #0a0a1a;
            border: 1px solid rgba(0, 255, 255, 0.5);
        }
        .tooltip {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .has-tooltip:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .gif-illustration {
            width: 100%;
            max-height: 200px;
            margin-top: 10px;
        }
        .flash-light {
            animation: sos-flash 2s infinite;
        }
        @keyframes sos-flash {
            0% { background-color: rgba(255, 255, 255, 0); }
            10% { background-color: rgba(255, 255, 255, 1); } /* Short */
            20% { background-color: rgba(255, 255, 255, 0); }
            30% { background-color: rgba(255, 255, 255, 1); } /* Short */
            40% { background-color: rgba(255, 255, 255, 0); }
            50% { background-color: rgba(255, 255, 255, 1); } /* Short */
            60% { background-color: rgba(255, 255, 255, 0); }
            70% { background-color: rgba(255, 255, 255, 1); } /* Long */
            90% { background-color: rgba(255, 255, 255, 0); }
            100% { background-color: rgba(255, 255, 255, 0); }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div id="game-container" class="max-w-7xl mx-auto">
        <!-- HEADER -->
        <header class="text-center mb-8">
            <h1 class="font-orbitron text-3xl md:text-5xl font-bold text-cyan-300 tracking-wider">
                PROJEKT CHIMERA
            </h1>
            <p class="text-cyan-100">
                Operation: Das Goldene Zeitalter // RUNDE:
                <span id="turn-counter">1</span>
            </p>
            <!-- Illustration GIF for game (e.g., climate crisis animation) -->
            <img src="https://media.giphy.com/media/3o7bu3XilJ5BOiSGic/giphy.gif" alt="Climate Crisis GIF" class="gif-illustration">
            <!-- SOS Morse Code Button -->
            <button id="sos-button" class="action-button p-2 mt-4 flash-light">Send SOS Signal (Light App Reaction)</button>
        </header>
        <!-- MAIN GRID -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- LEFT COLUMN: RESOURCES & PROGRESS -->
            <section class="lg:col-span-1 space-y-6">
                <!-- RESOURCES -->
                <div class="resource-card rounded-lg p-4">
                    <h2 class="font-orbitron text-xl mb-4 border-b border-cyan-700 pb-2">
                        Kommando-Ressourcen
                    </h2>
                    <div id="resources-grid" class="grid grid-cols-2 gap-4">
                        <!-- Resources will be injected here by JS -->
                    </div>
                </div>
                <!-- PROGRESS -->
                <div class="resource-card rounded-lg p-4">
                    <h2 class="font-orbitron text-xl mb-4 border-b border-cyan-700 pb-2">
                        Globale Projekte
                    </h2>
                    <div id="progress-bars" class="space-y-4">
                        <!-- Progress bars will be injected here by JS -->
                    </div>
                </div>
            </section>
            <!-- MIDDLE COLUMN: ACTIONS -->
            <section class="lg:col-span-1 space-y-4">
                <div class="resource-card rounded-lg p-4 h-full">
                    <h2 class="font-orbitron text-xl mb-4 border-b border-cyan-700 pb-2">
                        Gambit-Matrix
                    </h2>
                    <div id="actions-container" class="space-y-3">
                        <!-- Action buttons will be injected here by JS -->
                    </div>
                    <!-- MOVES GIF on Gambit click -->
                    <img id="moves-gif" src="https://media.giphy.com/media/l0HlK8VUCtB2G4m52/giphy.gif" alt="MOVES GIF" class="gif-illustration hidden">
                    <!-- TWISTS GIF on Gambit click -->
                    <img id="twists-gif" src="https://media.giphy.com/media/26FLgGTPsEIAq8vs/giphy.gif" alt="TWISTS GIF" class="gif-illustration hidden">
                </div>
            </section>
            <!-- RIGHT COLUMN: LOG & EVENTS -->
            <section class="lg:col-span-1 space-y-4">
                <div class="resource-card rounded-lg p-4 h-full">
                    <h2 class="font-orbitron text-xl mb-4 border-b border-cyan-700 pb-2">
                        Operations-Log
                    </h2>
                    <!-- Looping Game Movie/GIF in Log -->
                    <img src="https://media.giphy.com/media/3o7abKhOpu0Nbn9uEo/giphy.gif" alt="Game Loop GIF" class="gif-illustration">
                    <div id="log-container" class="h-96 overflow-y-auto pr-2 space-y-3">
                        <!-- Log entries will be injected here by JS -->
                    </div>
                </div>
            </section>
        </main>
    </div>
    <!-- MODAL erweitert um Reaktions-Buttons und Multimedia -->
    <div id="modal" class="fixed inset-0 z-50 items-center justify-center hidden modal-backdrop">
        <div class="modal-content rounded-lg p-8 m-4 max-w-4xl w-full h-4/5 shadow-2xl shadow-cyan-500/20 overflow-auto">
            <h3 id="modal-title" class="font-orbitron text-2xl mb-4 text-cyan-300"></h3>
            <p id="modal-body" class="mb-6"></p>
            <div id="modal-media" class="mb-4 h-full"></div> <!-- Für iframe/GIF/Audio -->
            <div id="reaction-buttons" class="space-y-2 mb-4"></div>
            <button id="modal-close" class="w-full action-button p-2 rounded-lg font-bold">Schließen</button>
        </div>
    </div>
    <script>
        // Levy Legacy Excerpts (summarized and integrated)
        const levyLegacyText = [
            "For a good part of my life, I read about the great booms and busts of history—the South Sea bubble, the tulip mania, the 1929 crash—but in the late 1990s, I knew my bubble had finally come. I’ve had two loves in my life: One is the stock market, the other psychology.",
            "Nothing ever happens without people making decisions. Even the bubbles wouldn’t be worth talking about without discussing the psychology that drove them.",
            "The moods of the market affect not only stock prices but also the fortunes of business. The Internet stock craze convinced me that there has never been a more important time to come to grips with what has happened to the markets.",
            "One can only hope that with experience will come the ability to recognize those things that do not change, even as fashions come and go. I’m fond of the remark, attributed to Mark Twain, that 'history does not repeat itself, at best it sometimes rhymes.'",
            "Markets affect investor psychology, but investor psychology also affects markets. Basically, we all live three lives: our life, the life of our parents, and that of our children.",
            "Good times breed laxity, laxity breeds unreliable numbers, and ultimately, unreliable numbers bring about bad times. This simple rhythm of markets is as predictable as human avarice.",
            "The message is that mood or investor psychology is as important to markets as is information. It requires tremendous discipline to apply this understanding to one’s behavior.",
            "Why should the market be any more perfect than the very human emotions and calculations that drive it? Investors overreact, and so do markets. Investors get swept up in moods, and so do markets."
        ];

        // --- GAME STATE INITIALIZATION ---
        let gameState = {
            turn: 1,
            levyRounds: 0,
            inLevyCycle: false,
            resources: {
                kapital: { name: "Kapital (Mrd.)", value: 10, icon: '💰'},
                daten: { name: "Datenströme (ZFlops)", value: 5, icon: '🌐'},
                legitimitaet: { name: "Legitimität (%)", value: 75, icon: '🏛️'},
                hebel: { name: "Hebel (Punkte)", value: 0, icon: '⚖️'},
            },
            progress: {
                theraFond: { name: "Thera-Climafonds", value: 0, goal: 1000, unlocked: false, description: "Baut den Fonds auf, um globale Projekte zu finanzieren."},
                github: { name: "GitHub Kontrolle", value: 0, goal: 100, description: "Erlange die Kontrolle über die wichtigste Code-Plattform der Welt, um 'Hebel' auf die Tech-Industrie zu bekommen."},
                klima: { name: "Klimastabilisierung", value: 0, goal: 100, unlocked: false, description: "Reduziere die globale Erwärmung durch Geo-Engineering."},
                mars: { name: "Mars-Kolonie", value: 0, goal: 200, unlocked: false, description: "Errichte eine autarke Basis auf dem Mars."},
                ceres: { name: "Ceres-Mission", value: 0, goal: 100, unlocked: false, description: "Starte eine Bergbaumission im Asteroidengürtel."},
            },
            gameOver: false,
        };

        // --- DREHBUCH SLOTS (erweitert für Goldene Zeitalter-Narrativ) ---
        const drehbuchSlots = [
            { id: 'ruf_zum_handeln', text: "EXT. NEUE ERDE – GOLDENE EBENEN – TAG: Chanelle rennt lachend durch das Gras... [PSPS II: 'Der Alpha und Omega hat uns dieses Zeitalter anvertraut.']", gif: 'https://media.giphy.com/media/26FLgGTPsEAq8vs/giphy.gif', emoji: '🚀', voiceText: 'Der Alpha und Omega hat uns dieses Zeitalter anvertraut. Die Mission beginnt von Neuem.' },
            { id: 'letzter_aufstand', text: "EXT. RUINEN DER ALTEN WELT – TAG: Henry führt seine Anhänger... [Henry: 'Wir werden ihr Paradies in den Abgrund ziehen.']", gif: 'https://media.giphy.com/media/l0HlK3VUCtB2G4m52/giphy.gif', emoji: '⚔️', voiceText: 'Der Hochmut des Dunklen Herrn verblendet ihn. Wähle das Licht.' },
            { id: 'urteil_alpha', text: "INT. DAS NEUE BETHEL – THRONSAAL – TAG: PSPS II: 'Barmherzigkeit triumphiert, Liebe siegt.'", gif: 'https://media.giphy.com/media/3o7abKhOpu0Nbn9uEo/giphy.gif', emoji: '👼', voiceText: 'Barmherzigkeit triumphiert, Liebe siegt.' },
            { id: 'sternenschiffe_start', text: "Szene 2: Neues Jerusalem steigt herab. PSPS II: 'Geht, erkundet – bewahrt das Leben über die Erde hinaus.'", gif: 'https://media.giphy.com/media/26FLgGTPsEIAq8vs/giphy.gif', emoji: '🌟', voiceText: 'Geht, erkundet – bewahrt das Leben über die Erde hinaus.' },
            { id: 'ceres_harmonie', text: "Finale Szene: Rachel aufersteht. 'Aus dem Reich des Planeten erhebe ich mich neu.'", gif: 'https://media.giphy.com/media/l0HlK8VUCtB2G4m52/giphy.gif', emoji: '🌹', voiceText: 'Aus dem Reich des Planeten erhebe ich mich neu.' }
        ];

        // --- GAMBITS (ACTIONS) DEFINITION (erweitert mit Effekten, um "not available" zu vermeiden) ---
        const gambits = [
            { id: 'studie', name: 'Wissenschaftliche Studie veröffentlichen', cost: { kapital: 1 }, effect: (state) => { state.resources.legitimitaet.value += 5; addLog("Studie veröffentlicht: Legitimität gestiegen! 📚", "event"); }, description: "Stärkt dein Ansehen als seriöser Think Tank. (Kosten: 1 Mrd. Kapital)" },
            { id: 'marktmanipulation', name: 'Marktmanipulation (Levy-Zyklus)', cost: { legitimitaet: 10 }, effect: (state) => { state.resources.kapital.value += 20; state.resources.hebel.value += 5; addLog("Markt manipuliert: Kapital und Hebel gestiegen! 💹", "event"); }, description: "Nutze Marktpsychologie, um Kapital zu generieren und 'Hebel' aufzubauen. (Kosten: 10 Legitimität)" },
            // ... (alle anderen Gambits ähnlich erweitert mit Effekten und Logs)
            // Neu: Mars-Mission Gambit mit Simulation
            { id: 'start_mars_mission', name: 'Mars-Mission starten 🚀', cost: { daten: 20 }, effect: (state) => { 
                state.progress.mars.value += 10;
                showModal('Mars-Mission: Goldene Zeitalter Erkundung', 'Starte die Reise zum Roten Planeten!');
                const modalMedia = document.getElementById('modal-media');
                if (modalMedia) modalMedia.innerHTML = `<iframe src="https://rosaryparish.my.canva.site/rosary-space-mission" width="100%" height="400" frameborder="0"></iframe>`;
                addLog("Mars-Mission gestartet: Erkunde das Sonnensystem! 🪐", "event");
                playVoice('Geht, erkundet – bewahrt das Leben über die Erde hinaus.');
                document.getElementById('moves-gif').src = 'https://media.giphy.com/media/26FLgGTPsEAq8vs/giphy.gif';
                document.getElementById('moves-gif').classList.remove('hidden');
            }, condition: (state) => state.progress.mars.unlocked, description: "Initiere die Mars-Erkundung im Goldenen Zeitalter. (Kosten: 20 Datenströme)" }
        ];

        // --- RANDOM EVENTS DEFINITION (erweitert mit interaktiven Reaktionen) ---
        const randomEvents = [
            // ... (bestehende Events)
            { title: "Micrometeoroid-Schauer ☄️", text: "Dein Schiff wird beschädigt!", effect: (state) => { state.resources.kapital.value -= 30; addLog("Meteoritenstrom trifft das Raumschiff! Stabilisiere es ☄️", "warning"); showInteractiveModal("Raum-Krise", "Schaden am Schiff – reagiere schnell!", [{ label: "Reparieren 🔧", action: () => { state.resources.daten.value -= 20; state.resources.kapital.value += 15; addLog("Reparatur erfolgreich! Schaden minimiert. 🔧", "event"); } }, { label: "Ignorieren ⚠️", action: () => { addLog("Schaden ignoriert – Risiko steigt! ⚠️", "warning"); } }], 'https://media.giphy.com/media/l0HlK3VUCtB2G4m52/giphy.gif', 'https://www.nasa.gov/wp-content/uploads/2023/04/insight-martian-wind.wav'); } },
            { title: "Alien-Entdeckung 🛸", text: "Hologramm zeigt Mars-Geschichte!", effect: (state) => { state.resources.hebel.value += 50; addLog("Aliens entdeckt: 'Martians seeded Earth' 🛸", "event"); showInteractiveModal("Alien-Kontakt", "Kontakt herstellen oder beobachten?", [{ label: "Kontakt herstellen 📡", action: () => { state.resources.daten.value += 20; addLog("Kontakt hergestellt: Daten-Gewinn! 📡", "event"); } }, { label: "Beobachten 👀", action: () => { addLog("Beobachtung: Kein Risiko, aber verpasster Boost. 👀", "info"); } }], 'https://media.giphy.com/media/3o7abKhOpu0Nbn9uEo/giphy.gif'); } }
        ];

        // Neu: Interaktives Modal für Events
        function showInteractiveModal(title, body, reactions = [], gifSrc = '', audioSrc = '') {
            modalTitle.innerText = title;
            modalBody.innerText = body;
            const mediaDiv = document.getElementById('modal-media');
            mediaDiv.innerHTML = '';
            if (gifSrc) mediaDiv.innerHTML += `<img src="${gifSrc}" alt="Event GIF" class="w-full mb-2">`;
            if (audioSrc) {
                const audio = new Audio(audioSrc);
                audio.play().catch(err => console.log(err));
            }
            const buttonsDiv = document.getElementById('reaction-buttons');
            buttonsDiv.innerHTML = '';
            reactions.forEach(reaction => {
                const btn = document.createElement('button');
                btn.className = 'w-full action-button p-2 mb-2 rounded-lg font-bold';
                btn.innerText = reaction.label;
                btn.onclick = () => { reaction.action(); modal.classList.add('hidden'); modal.classList.remove('flex'); render(); };
                buttonsDiv.appendChild(btn);
            });
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            playVoice(body);
        }

        // Voice-Funktion (erweitert)
        let voicesLoaded = false;
        function playVoice(text) {
            if ('speechSynthesis' in window && voicesLoaded) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'de-DE';
                speechSynthesis.speak(utterance);
            }
        }
        speechSynthesis.onvoiceschanged = () => { voicesLoaded = true; };

        // --- GAME LOGIC FUNCTIONS (erweitert für dynamische Logs) ---
        function addLog(message, type = 'info', isDynamic = true) {
            const colorClasses = {
                info: 'text-gray-300 border-cyan-500',
                event: 'text-yellow-300 border-yellow-500',
                warning: 'text-red-400 border-red-500',
                victory: 'text-green-300 border-green-500 font-bold',
                narrative: 'text-purple-300 border-purple-500'
            };
            if (isDynamic && drehbuchSlots.length > 0) {
                const randomSlot = drehbuchSlots[Math.floor(Math.random() * drehbuchSlots.length)];
                message = `${randomSlot.emoji} ${message}: "${randomSlot.text.substring(0, 50)}..."`;
            }
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry p-2 text-sm ${colorClasses[type] || colorClasses.info}`;
            logEntry.innerHTML = `<span class="font-bold">[Runde ${gameState.turn}]</span> ${message}`;
            logContainer.prepend(logEntry);
        }

        // Weitere Funktionen (executeGambit, nextTurn, checkVictory, showModal) unverändert, aber mit Calls zu addLog für narrative Inhalte.

        // INITIALIZE GAME
        window.onload = () => {
            addLog("Willkommen im Goldenen Zeitalter! Deine Mission beginnt... 🌟", "event");
            render();
        };
    </script>
    ©®™ ROSARY 2025 ff
    Be a hero! -"CHIM"
</body>
</html>
